// Sample Data - Replace with your actual content
const sampleData = [
  {
    id: 1,
    title: "বাংলাদেশী ছেলের অসাধারণ ট্যালেন্ট ভাইরাল!",
    description:
      "একজন বাংলাদেশী তরুণের অবিশ্বাস্য গানের প্রতিভা দেখে সবাই অবাক! ভিডিওটি মাত্র ২৪ ঘন্টায় ১০ লক্ষ ভিউ পেয়েছে।",
    thumbnail: "images/782509.jpg",
    category: "videos",
    type: "video",
    videoUrl: "https://www.youtube.com/embed/dQw4w9WgXcQ",
    date: "2025-06-05",
    views: "1.2M",
    likes: "50K",
    content: `
                    <p>এই ভিডিওতে একজন বাংলাদেশী তরুণ তার অসাধারণ গানের প্রতিভা প্রদর্শন করেছেন যা দেখে সবাই মুগ্ধ হয়ে গেছে।</p>
                    
                    <p>ভিডিওটি সামাজিক মাধ্যমে ব্যাপক জনপ্রিয়তা পেয়েছে এবং অনেক বিখ্যাত ব্যক্তিত্ব এই তরুণের প্রশংসা করেছেন।</p>
                    
                    <h3>কেন এই ভিডিও ভাইরাল হলো?</h3>
                    <ul>
                        <li>অসাধারণ গানের প্রতিভা</li>
                        <li>আবেগময় পারফরম্যান্স</li>
                        <li>দেশীয় সুরের সুন্দর মিশ্রণ</li>
                    </ul>
                    
                    <p>আপনিও এই অসাধারণ পারফরম্যান্স দেখুন এবং শেয়ার করুন!</p>
                `,
  },
  {
    id: 2,
    title: "মজার বিয়ের ছবি যা ইন্টারনেট কাঁপিয়ে দিয়েছে",
    description:
      "একটি বিয়ের অনুষ্ঠানের হাস্যকর ছবি যা দেখে সবাই হেসে পেট ব্যথা! এই ছবিটি ফেসবুকে ৫ লক্ষ শেয়ার হয়েছে।",
    thumbnail: "https://i.ibb.co/sample-wedding.jpg",
    category: "images",
    type: "image",
    imageUrl: "https://i.ibb.co/sample-wedding-large.jpg",
    date: "2025-06-04",
    views: "800K",
    likes: "35K",
    content: `
                    <img src="https://i.ibb.co/sample-wedding-large.jpg" alt="Viral Wedding Photo" style="width: 100%; border-radius: 10px; margin: 1rem 0;">
                    
                    <p>এই বিয়ের ছবিটি ইন্টারনেটে ভাইরাল হওয়ার পর থেকে সবাই এটি নিয়ে মজার মজার কমেন্ট করছে।</p>
                    
                    <p>ছবিতে দেখা যাচ্ছে যে বর-কনে এবং তাদের পরিবারের সদস্যরা একটি অপ্রত্যাশিত পরিস্থিতিতে পড়েছেন যা দেখতে খুবই মজার।</p>
                    
                    <h3>কেন এই ছবি এত জনপ্রিয় হলো?</h3>
                    <ul>
                        <li>অপ্রত্যাশিত মুহূর্ত</li>
                        <li>সবার মুখের হাস্যকর অভিব্যক্তি</li>
                        <li>দেশীয় বিয়ের প্রকৃত চিত্র</li>
                    </ul>
                    
                    <p>আপনিও এই মজার ছবি দেখুন এবং বন্ধুদের সাথে শেয়ার করুন!</p>
                `,
  },
  {
    id: 3,
    title: "রিকশাওয়ালার গলায় এত সুন্দর গান!",
    description:
      "ঢাকার একজন রিকশাওয়ালার গানের ভিডিও দেখে সবাই অভিভূত। তার গলার জাদু শুনলে মন ভালো হয়ে যাবে।",
    thumbnail: "https://i.ibb.co/sample-rickshaw.jpg",
    category: "videos",
    type: "video",
    videoUrl: "https://www.youtube.com/embed/sample-rickshaw-song",
    date: "2025-06-03",
    views: "2.1M",
    likes: "85K",
    content: `
                    <p>ঢাকার একজন সাধারণ রিকশাওয়ালার গানের এই ভিডিও সামাজিক মাধ্যমে ঝড় তুলেছে।</p>
                    
                    <p>তার গলার সুরে রয়েছে এমন এক জাদু যা শুনলে যে কেউ মুগ্ধ হয়ে যাবে। অনেকে বলছেন যে তিনি একজন প্রকৃত শিল্পী।</p>
                    
                    <h3>এই ভিডিওর বিশেষত্ব:</h3>
                    <ul>
                        <li>স্বতঃস্ফূর্ত গানের পরিবেশনা</li>
                        <li>হৃদয়স্পর্শী সুরের মূর্ছনা</li>
                        <li>সাধারণ মানুষের অসাধারণ প্রতিভা</li>
                    </ul>
                    
                    <p>এই রিকশাওয়ালা ভাইয়ের গান শুনে আপনার মন ভালো হয়ে যাবে নিশ্চিত!</p>
                `,
  },
  {
    id: 4,
    title: "বাংলাদেশী মেয়ের ড্যান্স ভিডিও ইন্ডিয়ায় ভাইরাল",
    description:
      "একজন বাংলাদেশী মেয়ের নাচের ভিডিও ভারতেও ভাইরাল হয়েছে। তার নাচের স্টাইল দেখে সবাই মুগ্ধ।",
    thumbnail: "https://i.ibb.co/sample-dance.jpg",
    category: "trending",
    type: "video",
    videoUrl: "https://www.youtube.com/embed/sample-dance-video",
    date: "2025-06-02",
    views: "3.5M",
    likes: "120K",
    content: `
                    <p>এই বাংলাদেশী মেয়ের নাচের ভিডিও শুধু বাংলাদেশেই নয়, ভারত এবং পাকিস্তানেও ব্যাপক জনপ্রিয়তা পেয়েছে।</p>
                    
                    <p>তার নাচের স্টাইল এবং এক্সপ্রেশন দেখে বোঝা যায় যে তিনি একজন প্রকৃত নর্তকী। অনেক বলিউড তারকাও তার প্রশংসা করেছেন।</p>
                    
                    <h3>কেন এই ভিডিও আন্তর্জাতিক পর্যায়ে জনপ্রিয়?</h3>
                    <ul>
                        <li>পারফেক্ট কোরিওগ্রাফি</li>
                        <li>দুর্দান্ত এক্সপ্রেশন</li>
                        <li>দেশীয় এবং আধুনিক নাচের মিশ্রণ</li>
                    </ul>
                    
                    <p>এই অসাধারণ পারফরম্যান্স দেখতে ভুলবেন না!</p>
                `,
  },
  {
    id: 5,
    title: "গ্রামের ছেলের মজার জোকস - হাসতে হাসতে পেট ব্যথা!",
    description:
      "একজন গ্রামের ছেলের স্বতঃস্ফূর্ত জোকস যা শুনলে আপনি হাসতে হাসতে গড়াগড়ি খাবেন। প্রকৃত দেশীয় হাস্যরস।",
    thumbnail: "https://i.ibb.co/sample-comedy.jpg",
    category: "stories",
    type: "text",
    date: "2025-06-01",
    views: "950K",
    likes: "42K",
    content: `
                    <p>এই গল্পটি একজন গ্রামের সরল ছেলের যে তার স্বতঃস্ফূর্ত জোকস দিয়ে সবাইকে হাসিয়ে দেয়।</p>
                    
                    <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 10px; margin: 1rem 0; border-left: 4px solid var(--primary-color);">
                        <h4>মজার ঘটনা:</h4>
                        <p>"একদিন আমার মামা বললেন, 'তোর নাকি ইংরেজি জানা আছে?' আমি বললাম, 'হ্যাঁ মামা, আমি ইংরেজিতে গরুর নাম বলতে পারি।' মামা বললেন, 'বল তো?' আমি বললাম, 'কাউ!'</p>
                        
                        <p>মামা অবাক হয়ে বললেন, 'আরো বল!' আমি বললাম, 'ছাগলের নাম গোট, মুরগির নাম চিকেন!' মামা খুশি হয়ে বললেন, 'বাহ! তুই তো অনেক জানিস!' আমি বললাম, 'হ্যাঁ মামা, আমি আরো জানি - হাতির নাম হাথি!'"</p>
                    </div>
                    
                    <p>এরকম আরো অনেক মজার গল্প রয়েছে এই ছেলের। তার সহজ সরল কথাবার্তা শুনলে মন ভালো হয়ে যায়।</p>
                    
                    <h3>কেন এই গল্প এত জনপ্রিয়?</h3>
                    <ul>
                        <li>খাঁটি দেশীয় হাস্যরস</li>
                        <li>সরল ও নির্দোষ কৌতুক</li>
                        <li>গ্রামীণ জীবনের প্রকৃত চিত্র</li>
                    </ul>
                    
                    <p>আপনিও এই মজার গল্প পড়ে হাসুন এবং বন্ধুদের সাথে শেয়ার করুন!</p>
                `,
  },
  {
    id: 5,
    title: "গ্রামের ছেলের মজার জোকস - হাসতে হাসতে পেট ব্যথা!",
    description:
      "একজন গ্রামের ছেলের স্বতঃস্ফূর্ত জোকস যা শুনলে আপনি হাসতে হাসতে গড়াগড়ি খাবেন। প্রকৃত দেশীয় হাস্যরস।",
    thumbnail: "https://i.ibb.co/sample-comedy.jpg",
    category: "stories",
    type: "text",
    date: "2025-06-01",
    views: "950K",
    likes: "42K",
    content: `
                    <p>এই গল্পটি একজন গ্রামের সরল ছেলের যে তার স্বতঃস্ফূর্ত জোকস দিয়ে সবাইকে হাসিয়ে দেয়।</p>
                    
                    <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 10px; margin: 1rem 0; border-left: 4px solid var(--primary-color);">
                        <h4>মজার ঘটনা:</h4>
                        <p>"একদিন আমার মামা বললেন, 'তোর নাকি ইংরেজি জানা আছে?' আমি বললাম, 'হ্যাঁ মামা, আমি ইংরেজিতে গরুর নাম বলতে পারি।' মামা বললেন, 'বল তো?' আমি বললাম, 'কাউ!'</p>
                        
                        <p>মামা অবাক হয়ে বললেন, 'আরো বল!' আমি বললাম, 'ছাগলের নাম গোট, মুরগির নাম চিকেন!' মামা খুশি হয়ে বললেন, 'বাহ! তুই তো অনেক জানিস!' আমি বললাম, 'হ্যাঁ মামা, আমি আরো জানি - হাতির নাম হাথি!'"</p>
                    </div>
                    
                    <p>এরকম আরো অনেক মজার গল্প রয়েছে এই ছেলের। তার সহজ সরল কথাবার্তা শুনলে মন ভালো হয়ে যায়।</p>
                    
                    <h3>কেন এই গল্প এত জনপ্রিয়?</h3>
                    <ul>
                        <li>খাঁটি দেশীয় হাস্যরস</li>
                        <li>সরল ও নির্দোষ কৌতুক</li>
                        <li>গ্রামীণ জীবনের প্রকৃত চিত্র</li>
                    </ul>
                    
                    <p>আপনিও এই মজার গল্প পড়ে হাসুন এবং বন্ধুদের সাথে শেয়ার করুন!</p>
                `,
  },
];

let currentData = [...sampleData];
let currentPost = null;

// Initialize the app
document.addEventListener("DOMContentLoaded", function () {
  loadContent();
  initializeTheme();
  setupSearch();
});

// Load content into grid
function loadContent(data = currentData) {
  const grid = document.getElementById("content-grid");

  if (data.length === 0) {
    grid.innerHTML = '<div class="loading"><p>No content found</p></div>';
    return;
  }

  grid.innerHTML = data
    .map(
      (item) => `
                <div class="content-card" onclick="showPost(${item.id})">
                    <div style="position: relative;">
                        <img src="${item.thumbnail}" alt="${
        item.title
      }" class="card-thumbnail" 
                             onerror="this.src='https://via.placeholder.com/300x200/006A4E/FFFFFF?text=Viral+Deshi'">
                        <div class="card-badge">${item.category.toUpperCase()}</div>
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">${item.title}</h3>
                        <p class="card-description">${item.description}</p>
                        <div class="card-meta">
                            <span><i class="fas fa-calendar"></i> ${formatDate(
                              item.date
                            )}</span>
                            <div class="card-stats">
                                <div class="stat-item">
                                    <i class="fas fa-eye"></i>
                                    <span>${item.views}</span>
                                </div>
                                <div class="stat-item">
                                    <i class="fas fa-heart"></i>
                                    <span>${item.likes}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `
    )
    .join("");
}

// Show individual post
function showPost(id) {
  const post = sampleData.find((p) => p.id === id);
  if (!post) return;

  currentPost = post;

  // Update post content
  document.getElementById("post-title").textContent = post.title;
  document.getElementById("post-date").textContent = formatDate(post.date);
  document.getElementById("post-views").textContent = post.views;
  document.getElementById("post-likes").textContent = post.likes;
  document.getElementById("post-content").innerHTML = post.content;

  // Handle media based on type
  const mediaContainer = document.getElementById("post-media");
  if (post.type === "video") {
    mediaContainer.innerHTML = `
                    <div class="video-container">
                        <iframe src="${post.videoUrl}" frameborder="0" allowfullscreen></iframe>
                    </div>
                `;
  } else if (post.type === "image") {
    mediaContainer.innerHTML = `
                    <img src="${post.imageUrl}" alt="${post.title}" style="width: 100%; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
                `;
  } else {
    mediaContainer.innerHTML = "";
  }

  // Show post page
  document.getElementById("home-page").style.display = "none";
  document.getElementById("post-page").style.display = "block";

  // Update URL without page reload
  window.history.pushState({ page: "post", id: id }, post.title, `#post-${id}`);

  // Update page title and meta
  document.title = `${post.title} - Viral Deshi`;
  updateMetaTags(post);

  // Scroll to top
  window.scrollTo(0, 0);
}

// Show home page
function showHome() {
  document.getElementById("home-page").style.display = "block";
  document.getElementById("post-page").style.display = "none";

  window.history.pushState({ page: "home" }, "Viral Deshi", "/");
  document.title = "Viral Deshi - Latest Bangladeshi Viral Content";

  window.scrollTo(0, 0);
}

// Filter content by category
function filterCategory(category) {
  // Update active tab
  document
    .querySelectorAll(".tab-btn")
    .forEach((btn) => btn.classList.remove("active"));
  event.target.classList.add("active");

  // Filter data
  if (category === "all") {
    currentData = [...sampleData];
  } else {
    currentData = sampleData.filter((item) => item.category === category);
  }

  loadContent(currentData);
}

// Search functionality
function setupSearch() {
  const searchInput = document.getElementById("searchInput");
  searchInput.addEventListener("keypress", function (e) {
    if (e.key === "Enter") {
      searchContent();
    }
  });
}

function searchContent() {
  const query = document
    .getElementById("searchInput")
    .value.toLowerCase()
    .trim();

  if (!query) {
    currentData = [...sampleData];
  } else {
    currentData = sampleData.filter(
      (item) =>
        item.title.toLowerCase().includes(query) ||
        item.description.toLowerCase().includes(query) ||
        item.content.toLowerCase().includes(query)
    );
  }

  loadContent(currentData);
}

// Theme toggle
function toggleTheme() {
  const body = document.body;
  const themeIcon = document.getElementById("theme-icon");

  body.classList.toggle("dark-mode");

  if (body.classList.contains("dark-mode")) {
    themeIcon.className = "fas fa-sun";
    localStorage.setItem("theme", "dark");
  } else {
    themeIcon.className = "fas fa-moon";
    localStorage.setItem("theme", "light");
  }
}

function initializeTheme() {
  const savedTheme = localStorage.getItem("theme");
  const body = document.body;
  const themeIcon = document.getElementById("theme-icon");

  if (savedTheme === "dark") {
    body.classList.add("dark-mode");
    themeIcon.className = "fas fa-sun";
  }
}

// Social sharing
function sharePost(platform) {
  if (!currentPost) return;

  const url = encodeURIComponent(window.location.href);
  const title = encodeURIComponent(currentPost.title);
  const description = encodeURIComponent(currentPost.description);

  let shareUrl = "";

  switch (platform) {
    case "facebook":
      shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
      break;
    case "twitter":
      shareUrl = `https://twitter.com/intent/tweet?url=${url}&text=${title}`;
      break;
    case "whatsapp":
      shareUrl = `https://wa.me/?text=${title}%20${url}`;
      break;
    case "telegram":
      shareUrl = `https://t.me/share/url?url=${url}&text=${title}`;
      break;
  }

  if (shareUrl) {
    window.open(shareUrl, "_blank", "width=600,height=400");
  }
}

// Utility functions
function formatDate(dateString) {
  const date = new Date(dateString);
  const now = new Date();
  const diffTime = Math.abs(now - date);
  const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

  if (diffDays === 1) return "Yesterday";
  if (diffDays < 7) return `${diffDays} days ago`;

  return date.toLocaleDateString("en-US", {
    year: "numeric",
    month: "short",
    day: "numeric",
  });
}

function updateMetaTags(post) {
  // Update Open Graph tags
  document
    .querySelector('meta[property="og:title"]')
    .setAttribute("content", post.title);
  document
    .querySelector('meta[property="og:description"]')
    .setAttribute("content", post.description);
  document
    .querySelector('meta[property="og:image"]')
    .setAttribute("content", post.thumbnail);

  // Update Twitter Card tags
  document
    .querySelector('meta[name="twitter:title"]')
    .setAttribute("content", post.title);
  document
    .querySelector('meta[name="twitter:description"]')
    .setAttribute("content", post.description);
  document
    .querySelector('meta[name="twitter:image"]')
    .setAttribute("content", post.thumbnail);
}

// Handle browser back/forward
window.addEventListener("popstate", function (event) {
  if (event.state) {
    if (event.state.page === "home") {
      showHome();
    } else if (event.state.page === "post") {
      showPost(event.state.id);
    }
  } else {
    showHome();
  }
});

// Handle initial URL
window.addEventListener("load", function () {
  const hash = window.location.hash;
  if (hash.startsWith("#post-")) {
    const id = parseInt(hash.replace("#post-", ""));
    showPost(id);
  }
});

// Lazy loading for images
document.addEventListener("DOMContentLoaded", function () {
  if ("IntersectionObserver" in window) {
    const imageObserver = new IntersectionObserver((entries, observer) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          const img = entry.target;
          img.src = img.dataset.src;
          img.classList.remove("lazy");
          imageObserver.unobserve(img);
        }
      });
    });

    document.querySelectorAll("img[data-src]").forEach((img) => {
      imageObserver.observe(img);
    });
  }
});

// Add smooth scrolling
document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
  anchor.addEventListener("click", function (e) {
    e.preventDefault();
    const target = document.querySelector(this.getAttribute("href"));
    if (target) {
      target.scrollIntoView({
        behavior: "smooth",
        block: "start",
      });
    }
  });
});

// Performance optimization - defer non-critical CSS
function loadNonCriticalCSS() {
  const link = document.createElement("link");
  link.rel = "stylesheet";
  link.href =
    "https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap";
  document.head.appendChild(link);
}

// Load non-critical resources after page load
window.addEventListener("load", loadNonCriticalCSS);
